"use strict";(self.webpackChunkperiscope=self.webpackChunkperiscope||[]).push([[9642],{9695:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"channels/API/response-webhook","title":"Response Webhook","description":"Response webhooks allow you to receive asynchronous responses from your AI agents. When an agent processes a request, it can send the response to a specified webhook endpoint in your application.","source":"@site/docs/channels/API/response-webhook.md","sourceDirName":"channels/API","slug":"/channels/API/response-webhook","permalink":"/docs/channels/API/response-webhook","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"API Keys","permalink":"/docs/channels/API/api-keys"}}');var t=s(4848),r=s(8453);const o={sidebar_position:3},d="Response Webhook",a={},l=[{value:"Configuring Webhooks",id:"configuring-webhooks",level:2},{value:"Security",id:"security",level:2},{value:"Verifying Signatures",id:"verifying-signatures",level:3},{value:"Webhook Payload",id:"webhook-payload",level:2},{value:"Sample Payload",id:"sample-payload",level:3},{value:"Payload Fields",id:"payload-fields",level:3},{value:"Metadata Handling",id:"metadata-handling",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Retry Mechanism",id:"retry-mechanism",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Testing Webhooks",id:"testing-webhooks",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"response-webhook",children:"Response Webhook"})}),"\n",(0,t.jsx)(n.p,{children:"Response webhooks allow you to receive asynchronous responses from your AI agents. When an agent processes a request, it can send the response to a specified webhook endpoint in your application."}),"\n",(0,t.jsx)(n.h2,{id:"configuring-webhooks",children:"Configuring Webhooks"}),"\n",(0,t.jsx)(n.p,{children:"To configure a webhook endpoint:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Navigate to the API channel settings"}),"\n",(0,t.jsx)(n.li,{children:"Enter your webhook URL"}),"\n",(0,t.jsx)(n.li,{children:"Set up a webhook secret for security"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,t.jsxs)(n.p,{children:["Webhook requests are secured using HMAC SHA-256 signatures. Each request includes a signature in the ",(0,t.jsx)(n.code,{children:"X-Signature"})," header that you can use to verify the authenticity of the webhook payload."]}),"\n",(0,t.jsx)(n.h3,{id:"verifying-signatures",children:"Verifying Signatures"}),"\n",(0,t.jsx)(n.p,{children:"To verify webhook signatures:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Get the signature from the ",(0,t.jsx)(n.code,{children:"X-Signature"})," header"]}),"\n",(0,t.jsx)(n.li,{children:"Create an HMAC SHA-256 hash of the raw request body using your webhook secret"}),"\n",(0,t.jsx)(n.li,{children:"Compare the generated hash with the signature"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Example signature verification in Node.js:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:'const crypto = require("crypto");\nfunction verifyWebhookSignature(payload, signature, secret) {\n  const hmac = crypto.createHmac("sha256", secret);\n  const expectedSignature = hmac.update(JSON.stringify(payload)).digest("hex");\n  return crypto.timingSafeEqual(\n    Buffer.from(signature),\n    Buffer.from(expectedSignature)\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"webhook-payload",children:"Webhook Payload"}),"\n",(0,t.jsx)(n.p,{children:"The webhook payload contains the agent's response and any metadata that was included in the original request."}),"\n",(0,t.jsx)(n.h3,{id:"sample-payload",children:"Sample Payload"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "user": {\n    "name": "John Doe",\n    "identity": "user-uuid-12345"\n  },\n  "chat_id": 1202,\n  "conversation_id": 1227,\n  "role": "assistant",\n  "type": "text",\n  "content": {\n    "text": "Please select a service from the options below..."\n  },\n  "timestamp": 1732546454586,\n  "metadata": {\n    "customer_id": "cust_123",\n    "session_id": "sess_456"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"payload-fields",children:"Payload Fields"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"user"})}),(0,t.jsx)(n.td,{children:"Object"}),(0,t.jsx)(n.td,{children:"Contains user information including name and unique identity"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"chat_id"})}),(0,t.jsx)(n.td,{children:"Number"}),(0,t.jsx)(n.td,{children:"Unique identifier for the chat"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"conversation_id"})}),(0,t.jsx)(n.td,{children:"Number"}),(0,t.jsx)(n.td,{children:"Unique identifier for the conversation"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"role"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:'Indicates the message sender ("assistant" or "user")'})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"type"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:'Type of message content (e.g., "text")'})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"content"})}),(0,t.jsx)(n.td,{children:"Object"}),(0,t.jsx)(n.td,{children:"Contains the actual message content"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"timestamp"})}),(0,t.jsx)(n.td,{children:"Number"}),(0,t.jsx)(n.td,{children:"Unix timestamp in milliseconds"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"metadata"})}),(0,t.jsx)(n.td,{children:"Object"}),(0,t.jsx)(n.td,{children:"Custom metadata passed in the original request"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"metadata-handling",children:"Metadata Handling"}),"\n",(0,t.jsx)(n.p,{children:"Any metadata included in your original API request will be automatically included in the webhook response. This allows you to maintain context and track conversations across your application."}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.p,{children:"The webhook system implements retry logic for failed deliveries. However, you should ensure your webhook endpoint:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Responds quickly (within 10 seconds)"}),"\n",(0,t.jsx)(n.li,{children:"Returns a 2xx status code to acknowledge receipt"}),"\n",(0,t.jsx)(n.li,{children:"Handles duplicate deliveries (webhooks may be sent multiple times)"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"retry-mechanism",children:"Retry Mechanism"}),"\n",(0,t.jsx)(n.p,{children:"If your webhook endpoint fails to respond with a 200 status code within 10 seconds, the system will automatically retry the delivery using exponential backoff, with a maximum of 3 retry attempts. After all retry attempts are exhausted, the delivery will be considered permanently failed."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note:"})," Due to these retries, your webhook handler must be idempotent as it may receive the same payload multiple times."]}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Implement Signature Verification"}),": Always verify webhook signatures to ensure the authenticity of requests."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Use HTTPS"}),": Your webhook endpoint should use HTTPS to ensure secure data transmission."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Handle Retries"}),": Design your webhook handler to be idempotent to handle potential duplicate deliveries."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Monitor Webhook Health"}),": Keep track of webhook delivery success rates and response times."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Store Webhook Logs"}),": Maintain logs of webhook deliveries for debugging and auditing purposes."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"testing-webhooks",children:"Testing Webhooks"}),"\n",(0,t.jsx)(n.p,{children:"You can test your webhook integration using the following steps:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Set up a test endpoint (e.g., using a service like webhook.site)"}),"\n",(0,t.jsx)(n.li,{children:"Configure the webhook URL in your channel settings"}),"\n",(0,t.jsx)(n.li,{children:"Send a test message through the API"}),"\n",(0,t.jsx)(n.li,{children:"Verify the webhook delivery and payload"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"For local development, you can use tools like ngrok to receive webhooks on your local machine."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var i=s(6540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);